<%@ Page Language="C#" MasterPageFile="~/MasterPage.master" AutoEventWireup="true" CodeFile="DayClosing.aspx.cs" Inherits="DayClosing" Title="Tsunami-ARMS Dayclosing" %>

<%@ Register Assembly="AjaxControlToolkit" Namespace="AjaxControlToolkit" TagPrefix="cc1" %>
<%--<asp:Content ID="Content1" ContentPlaceHolderID="ContentPlaceHolder2" Runat="Server">
  <br />
    <br />
  <asp:Panel ID="pnluserlink" runat="server" GroupingText="Quick links" Height="100%"
        Width="150px">
        <br />
        <asp:HyperLink ID="hlstaffmaster" runat="server" Height="32px" NavigateUrl="~/StaffMaster.aspx"
            Visible="False" Width="128px">Staff master</asp:HyperLink><asp:HyperLink ID="hlroommaster"
                runat="server" Height="32px" NavigateUrl="~/roommaster1.aspx" Visible="False"
                Width="128px">Room master</asp:HyperLink><asp:HyperLink ID="hldonormaster" runat="server"
                    Height="32px" NavigateUrl="~/DonorMaster.aspx" Visible="False" Width="128px">Donor master</asp:HyperLink><asp:HyperLink
                        ID="hlcomplaintmaster" runat="server" Height="32px" NavigateUrl="~/ComplaintMaster.aspx"
                        Visible="False" Width="125px">Complaint master</asp:HyperLink><asp:HyperLink ID="hlteammaster"
                            runat="server" Height="32px" NavigateUrl="~/TeamMaster.aspx" Visible="False"
                            Width="128px">Team master</asp:HyperLink><asp:HyperLink ID="hlinvmaster" runat="server"
                                Height="32px" NavigateUrl="~/inventorymaster.aspx" Visible="False" Width="127px">Inventory master</asp:HyperLink><asp:HyperLink
                                    ID="hlseasonmstr" runat="server" Height="32px" NavigateUrl="~/SeasonMaster.aspx"
                                    Visible="False" Width="126px">Season master</asp:HyperLink><span style="font-size: 9pt"></span><asp:HyperLink
                                        ID="hlsubmaster" runat="server" Height="32px" NavigateUrl="~/Submasters.aspx"
                                        Visible="False" Width="128px">Submasters</asp:HyperLink><asp:HyperLink ID="hlreservpol"
                                            runat="server" Height="32px" NavigateUrl="~/ReservationPolicy.aspx" Visible="False" Width="127px">reservation Policy</asp:HyperLink><asp:HyperLink
                                                ID="hlroolallocpol" runat="server" Height="32px" NavigateUrl="~/Room Allocation Policy.aspx"
                                                Visible="False" Width="127px">Room Alloc Policy</asp:HyperLink><asp:HyperLink ID="hlbillpolicy"
                                                    runat="server" Height="32px" NavigateUrl="~/Billing and Service charge policy.aspx"
                                                    Visible="False" Width="128px">Bill n service policy</asp:HyperLink><asp:HyperLink
                                                        ID="hlbankpolicy" runat="server" Height="32px" NavigateUrl="~/Cashier and Bank Remittance Policy.aspx"
                                                        Visible="False" Width="127px">Bank policy</asp:HyperLink><asp:HyperLink ID="hlroomallocation"
                                                            runat="server" Height="32px" NavigateUrl="~/roomallocation.aspx" Visible="False"
                                                            Width="128px">Room allocation</asp:HyperLink><asp:HyperLink ID="hlroomreservation"
                                                                runat="server" Height="32px" NavigateUrl="~/Room Reservation.aspx" Visible="False"
                                                                Width="126px">Room reservation</asp:HyperLink><asp:HyperLink ID="hlvacating" runat="server"
                                                                    Height="32px" NavigateUrl="~/vacating and billing.aspx" Visible="False" Width="128px">Room Vacating</asp:HyperLink><asp:HyperLink
                                                                        ID="hldonorpass" runat="server" Height="32px" NavigateUrl="~/donorpassfinal.aspx"
                                                                        Visible="False" Width="128px">Donor pass</asp:HyperLink><span style="font-size: 9pt"></span><asp:HyperLink
                                                                            ID="hlcmplntrgstr" runat="server" Height="32px" NavigateUrl="~/Complaint Register.aspx"
                                                                            Visible="False" Width="129px">Complaint register</asp:HyperLink><span style="font-size: 9pt">
                                                                            </span>
        <asp:HyperLink ID="hlchellanentry" runat="server" Height="32px" NavigateUrl="~/Chellan Entry.aspx"
            Visible="False" Width="128px">Chellan entry</asp:HyperLink><span style="font-size: 9pt"></span><asp:HyperLink
                ID="hlroomrsrce" runat="server" Height="32px" NavigateUrl="~/Room Resource Register.aspx"
                Visible="False" Width="128px">Room resource</asp:HyperLink><span style="font-size: 9pt"></span><asp:HyperLink
                    ID="hlusercrtn" runat="server" Height="32px" NavigateUrl="~/User Account Information.aspx"
                    Visible="False" Width="128px">User creation</asp:HyperLink><span style="font-size: 9pt"></span><asp:HyperLink
                        ID="hluserprvlge" runat="server" Height="32px" NavigateUrl="~/UserPrivilegeSettings.aspx"
                        Visible="False" Width="128px">User privilege</asp:HyperLink><asp:HyperLink ID="hlprinter"
                            runat="server" Height="32px" NavigateUrl="~/PlainPreprintedSettings.aspx" Visible="False"
                            Width="127px">Printer settings</asp:HyperLink><asp:HyperLink ID="hldayclose" runat="server"
                                Height="32px" NavigateUrl="~/DayClosing.aspx" Visible="False" Width="126px">Day close</asp:HyperLink><asp:HyperLink
                                    ID="hlroommgmnt" runat="server" Height="32px" NavigateUrl="~/Room Management.aspx"
                                    Visible="False" Width="125px">Room management</asp:HyperLink><asp:HyperLink ID="hlinvmngmnt"
                                        runat="server" Height="32px" NavigateUrl="~/Room Inventory Management.aspx" Visible="False"
                                        Width="128px">Inventory mangement</asp:HyperLink><asp:HyperLink ID="hlhkmagmnt" runat="server"
                                            Height="32px" NavigateUrl="~/HK management.aspx" Visible="False" Width="128px">HK management</asp:HyperLink><br />
        <asp:HyperLink ID="hlnonvacatingalert" runat="server" Height="31px" NavigateUrl="~/Nonvecatingroomalert.aspx"
            Width="127px">Non vacating alert</asp:HyperLink></asp:Panel>

</asp:Content>--%>
<asp:Content ID="Content2" ContentPlaceHolderID="ContentPlaceHolder1" Runat="Server">
    <asp:ScriptManager id="ScriptManager2" runat="server">
    </asp:ScriptManager>
    <asp:UpdatePanel id="UpdatePanel1" runat="server">
        <contenttemplate>
<TABLE><TBODY><TR><TD style="HEIGHT: 22px; TEXT-ALIGN: center" colSpan=2><asp:Label id="lblLabel5" runat="server" ForeColor="Blue" Text="Day Closing" Font-Bold="True" __designer:wfdid="w3" Font-Size="Large"></asp:Label></TD></TR><TR><TD><asp:Panel id="Panel1" runat="server" GroupingText="Day Closing" ForeColor="Blue"><TABLE><TBODY><TR><TD vAlign=middle>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <asp:Label id="LblCurrentDate" runat="server" Width="103px" Height="1px" Text=" Current date" Font-Bold="True" __designer:wfdid="w112" Font-Size="Medium"></asp:Label></TD><TD><asp:TextBox id="txtDaycloseDate" runat="server" Width="140px" Height="22px" ForeColor="Black" Font-Bold="True" __designer:wfdid="w2" Font-Size="Medium" OnTextChanged="txtcurdate_TextChanged" AutoPostBack="True" Enabled="False"></asp:TextBox></TD></TR><TR><TD></TD><TD><BR /></TD></TR><TR><TD><asp:Button id="BtnDayClosing" onclick="BtnDayClosing_Click1" runat="server" Text="Day Closing" __designer:wfdid="w3" CssClass="btnStyle_large"></asp:Button></TD><TD>&nbsp;&nbsp;&nbsp;&nbsp;<asp:Button id="btneport" onclick="btnreport_Click" runat="server" Text="Report" __designer:wfdid="w4" CssClass="btnStyle_large"></asp:Button></TD></TR></TBODY></TABLE></asp:Panel></TD><TD style="WIDTH: 332px"><asp:Panel id="Panel2" runat="server" GroupingText="Login" BackColor="Silver" __designer:wfdid="w57" Visible="False"><TABLE><TBODY><TR><TD><asp:Label id="lblusername" runat="server" Text="Username" __designer:wfdid="w63"></asp:Label></TD><TD><asp:TextBox id="txtusername" runat="server" Width="159px" OnTextChanged="txtusername_TextChanged" AutoPostBack="True" __designer:wfdid="w64"></asp:TextBox></TD></TR><TR><TD><asp:Label id="Password" runat="server" Text="Password" __designer:wfdid="w65"></asp:Label></TD><TD><asp:TextBox id="txtpassword" runat="server" Width="159px" OnTextChanged="txtpassword_TextChanged" TextMode="Password" __designer:wfdid="w66"></asp:TextBox></TD></TR><TR><TD style="WIDTH: 100px; HEIGHT: 29px"></TD><TD style="WIDTH: 92px; HEIGHT: 29px"><asp:Button id="btnlogin" onclick="Login_Click" runat="server" Width="69px" Height="27px" Text="Submit" __designer:wfdid="w67"></asp:Button></TD></TR></TBODY></TABLE></asp:Panel></TD></TR><TR><TD colSpan=2><asp:Panel id="Panel3" runat="server" GroupingText="Reports" __designer:wfdid="w68" Visible="False"><TABLE><TBODY><TR><TD colSpan=3><asp:Label id="Label1" runat="server" Width="81px" Text="From date" __designer:wfdid="w69"></asp:Label></TD><TD style="WIDTH: 1px" colSpan=1></TD><TD colSpan=1><asp:TextBox id="txtFromDate" runat="server" Width="146px" __designer:wfdid="w70" OnTextChanged="txtfromdated_TextChanged" AutoPostBack="True"></asp:TextBox></TD><TD style="TEXT-ALIGN: right" colSpan=1><asp:Label id="Label2" runat="server" Width="63px" Text="To date" __designer:wfdid="w8"></asp:Label>&nbsp; </TD><TD colSpan=1><asp:TextBox id="txtToDate" runat="server" __designer:wfdid="w72" OnTextChanged="txttodated_TextChanged" AutoPostBack="True"></asp:TextBox></TD></TR><TR><TD colSpan=5><asp:LinkButton id="LnkBtnReport" onclick="LnkBtnReport_Click" runat="server" Width="164px" Height="21px" CausesValidation="False" Font-Bold="True" __designer:wfdid="w73">Day close report</asp:LinkButton></TD><TD colSpan=1><asp:LinkButton id="lb_lregister" runat="server" Height="21px" CausesValidation="False" Font-Bold="True" __designer:wfdid="w1" OnClick="lb_lregister_Click">Liability Register</asp:LinkButton></TD><TD colSpan=1><asp:LinkButton id="LinkButton4" runat="server" Height="21px" CausesValidation="False" Font-Bold="True" __designer:wfdid="w2" OnClick="LinkButton4_Click">.Excel</asp:LinkButton></TD></TR><TR><TD colSpan=5><asp:LinkButton id="LinkButton1" onclick="LinkButton1_Click" runat="server" Width="226px" Font-Bold="True" __designer:wfdid="w74">Daily collection report</asp:LinkButton></TD><TD colSpan=1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <asp:Label id="Label4" runat="server" Width="88px" Text="Day close date" __designer:wfdid="w75"></asp:Label></TD><TD colSpan=1><asp:TextBox id="txtDaycloseDatere" runat="server" __designer:wfdid="w76"></asp:TextBox></TD></TR><TR><TD colSpan=5><asp:LinkButton id="LinkButton2" onclick="LinkButton2_Click" runat="server" Width="215px" Font-Bold="True" __designer:wfdid="w77">Bank remittance report</asp:LinkButton></TD><TD colSpan=2><cc1:CalendarExtender id="CalendarExtender3" runat="server" __designer:wfdid="w5" TargetControlID="txtDaycloseDatere" Format="dd/MM/yyyy"></cc1:CalendarExtender></TD></TR><TR><TD colSpan=5><asp:LinkButton id="LinkButton3" onclick="LinkButton3_Click" runat="server" Width="214px" Font-Bold="True" __designer:wfdid="w79">Season collection comparison</asp:LinkButton></TD><TD style="TEXT-ALIGN: right" colSpan=1><asp:Label id="lblIP" runat="server" Text="Server IP Address" __designer:wfdid="w5"></asp:Label></TD><TD colSpan=1><asp:TextBox id="txtIP" runat="server" __designer:wfdid="w4"></asp:TextBox></TD></TR><TR><TD colSpan=5></TD><TD style="TEXT-ALIGN: right" colSpan=1><asp:Label id="lblDatabase" runat="server" Text="Database Name" __designer:wfdid="w6"></asp:Label></TD><TD colSpan=1><asp:TextBox id="txtDB" runat="server" __designer:wfdid="w3"></asp:TextBox></TD></TR><TR><TD colSpan=5></TD><TD style="TEXT-ALIGN: right" colSpan=1></TD><TD colSpan=1></TD></TR><TR><TD colSpan=5></TD><TD style="TEXT-ALIGN: right" colSpan=1><asp:Button id="btnFileBackUp" onclick="btnFileBackUp_Click" runat="server" Text="Back Up  Server Files" __designer:wfdid="w1" CssClass="btnStyle_large"></asp:Button></TD><TD colSpan=1><asp:Button id="btnDBBackUp" onclick="btnDBBackUp_Click" runat="server" Text="Back Up Database" __designer:wfdid="w2" CssClass="btnStyle_large"></asp:Button></TD></TR><TR><TD colSpan=5><asp:Button id="btnCloseReports" onclick="btnCloseReports_Click" runat="server" Text="CloseReport" __designer:wfdid="w1" CssClass="btnStyle_large"></asp:Button></TD><TD style="TEXT-ALIGN: right" colSpan=1></TD><TD colSpan=1></TD></TR></TBODY></TABLE></asp:Panel></TD></TR><TR><TD style="HEIGHT: 746px" align=center colSpan=2>&nbsp; <cc1:ValidatorCalloutExtender id="ValidatorCalloutExtender1" runat="server" __designer:wfdid="w80" TargetControlID="RegularExpressionValidator2">
    </cc1:ValidatorCalloutExtender> <asp:RegularExpressionValidator id="RegularExpressionValidator2" runat="server" Width="89px" ForeColor="White" __designer:wfdid="w81" ValidationExpression="^(?=\d)(?:(?:31(?!.(?:0?[2469]|11))|(?:30|29)(?!.0?2)|29(?=.0?2.(?:(?:(?:1[6-9]|[2-9]\d)?(?:0[48]|[2468][048]|[13579][26])|(?:(?:16|[2468][048]|[3579][26])00)))(?:\x20|$))|(?:2[0-8]|1\d|0?[1-9]))([-./])(?:1[012]|0?[1-9])\1(?:1[6-9]|[2-9]\d)?\d\d(?:(?=\x20\d)\x20|$))?(((0?[1-9]|1[012])(:[0-5]\d){0,2}(\x20[AP]M))|([01]\d|2[0-3])(:[0-5]\d){1,2})?$" ErrorMessage="dd/mm/yyyy" ControlToValidate="txtDaycloseDate"></asp:RegularExpressionValidator>&nbsp;&nbsp; <asp:Panel id="pnlMessage" runat="server" __designer:wfdid="w82" _="" _designer:dtid="562958543355909" CssClass="ModalWindow"><asp:Panel id="Panel4" runat="server" BackColor="LightSteelBlue" __designer:wfdid="w83" BorderStyle="Outset"><asp:Label id="lblHead" runat="server" ForeColor="MediumBlue" Text="Tsunami ARMS - " Font-Bold="True" __designer:wfdid="w84"></asp:Label></asp:Panel> <ajaxToolkit:ModalPopupExtender id="ModalPopupExtender1" runat="server" __designer:wfdid="w85" TargetControlID="btnHidden" PopupControlID="pnlMessage" RepositionMode="RepositionOnWindowResize">
                </ajaxToolkit:ModalPopupExtender> <asp:Button style="DISPLAY: none" id="btnHidden" runat="server" Text="Hidden" __designer:wfdid="w86"></asp:Button> <asp:TextBox id="TextBox1" runat="server" __designer:wfdid="w87" OnTextChanged="TextBox1_TextChanged" AutoPostBack="True"></asp:TextBox> <asp:Label id="Label3" runat="server" Text="Label" __designer:wfdid="w88"></asp:Label> <BR /><asp:Panel id="pnlYesNo" runat="server" HorizontalAlign="Center" __designer:wfdid="w89"><TABLE style="WIDTH: 254px"><TBODY><TR><TD style="WIDTH: 5px" vAlign=middle align=center colSpan=1></TD><TD vAlign=middle align=center colSpan=3><asp:Label id="lblMsg" runat="server" ForeColor="Black" Text="Do you want to save?" __designer:wfdid="w90" Font-Size="Small"></asp:Label></TD></TR><TR><TD style="WIDTH: 5px" vAlign=middle align=center></TD><TD vAlign=middle align=center></TD><TD vAlign=middle align=center></TD></TR><TR><TD style="WIDTH: 5px" vAlign=middle align=center></TD><TD vAlign=middle align=center>&nbsp;&nbsp; <asp:Button id="btnYes" onclick="btnYes_Click" runat="server" Width="50px" CausesValidation="False" Text="Yes" __designer:wfdid="w91" CssClass="btnStyle"></asp:Button> <asp:Button id="btnNo" onclick="btnNo_Click" runat="server" Width="50px" CausesValidation="False" Text="No" __designer:wfdid="w92" CssClass="btnStyle"></asp:Button>&nbsp;</TD><TD vAlign=middle align=center>&nbsp;</TD></TR><TR><TD style="WIDTH: 5px; HEIGHT: 24px" vAlign=middle align=center></TD><TD vAlign=middle align=center></TD><TD style="HEIGHT: 24px" vAlign=middle align=center></TD></TR></TBODY></TABLE></asp:Panel> <asp:Panel id="pnlOk" runat="server" HorizontalAlign="Center" __designer:wfdid="w93"><TABLE><TBODY><TR><TD align=center colSpan=1></TD><TD align=center colSpan=3><asp:Label id="lblOk" runat="server" Width="242px" ForeColor="Black" Text="Do you want to ?" __designer:wfdid="w94" Font-Size="Small"></asp:Label></TD></TR><TR><TD></TD><TD></TD><TD></TD></TR><TR><TD></TD><TD align=center>&nbsp;&nbsp;&nbsp; <asp:Button id="btnOk" onclick="btnOk_Click" runat="server" Width="50px" CausesValidation="False" Text="OK" __designer:wfdid="w95" CssClass="btnStyle"></asp:Button> &nbsp; </TD><TD align=center>&nbsp;</TD></TR><TR><TD></TD><TD align=center></TD><TD align=center></TD></TR></TBODY></TABLE></asp:Panel> </asp:Panel> <asp:RegularExpressionValidator id="RegularExpressionValidator4" runat="server" ForeColor="White" __designer:wfdid="w96" ValidationExpression="^(?=\d)(?:(?:31(?!.(?:0?[2469]|11))|(?:30|29)(?!.0?2)|29(?=.0?2.(?:(?:(?:1[6-9]|[2-9]\d)?(?:0[48]|[2468][048]|[13579][26])|(?:(?:16|[2468][048]|[3579][26])00)))(?:\x20|$))|(?:2[0-8]|1\d|0?[1-9]))([-./])(?:1[012]|0?[1-9])\1(?:1[6-9]|[2-9]\d)?\d\d(?:(?=\x20\d)\x20|$))?(((0?[1-9]|1[012])(:[0-5]\d){0,2}(\x20[AP]M))|([01]\d|2[0-3])(:[0-5]\d){1,2})?$" ErrorMessage="Enter valid date" ControlToValidate="txtDaycloseDatere"></asp:RegularExpressionValidator> <cc1:ValidatorCalloutExtender id="ValidatorCalloutExtender4" runat="server" __designer:wfdid="w97" TargetControlID="RegularExpressionValidator4"></cc1:ValidatorCalloutExtender> <cc1:CalendarExtender id="CalendarExtender2" runat="server" __designer:wfdid="w98" TargetControlID="txtToDate" Format="dd/MM/yyyy"></cc1:CalendarExtender> &nbsp; <asp:RegularExpressionValidator id="RegularExpressionValidator1" runat="server" ForeColor="Snow" __designer:wfdid="w99" ValidationExpression="^(?=\d)(?:(?:31(?!.(?:0?[2469]|11))|(?:30|29)(?!.0?2)|29(?=.0?2.(?:(?:(?:1[6-9]|[2-9]\d)?(?:0[48]|[2468][048]|[13579][26])|(?:(?:16|[2468][048]|[3579][26])00)))(?:\x20|$))|(?:2[0-8]|1\d|0?[1-9]))([-./])(?:1[012]|0?[1-9])\1(?:1[6-9]|[2-9]\d)?\d\d(?:(?=\x20\d)\x20|$))?(((0?[1-9]|1[012])(:[0-5]\d){0,2}(\x20[AP]M))|([01]\d|2[0-3])(:[0-5]\d){1,2})?$" ErrorMessage="dd/mm/yyyy" ControlToValidate="txtFromDate"></asp:RegularExpressionValidator> <asp:RegularExpressionValidator id="RegularExpressionValidator3" runat="server" ForeColor="Snow" __designer:wfdid="w100" ValidationExpression="^(?=\d)(?:(?:31(?!.(?:0?[2469]|11))|(?:30|29)(?!.0?2)|29(?=.0?2.(?:(?:(?:1[6-9]|[2-9]\d)?(?:0[48]|[2468][048]|[13579][26])|(?:(?:16|[2468][048]|[3579][26])00)))(?:\x20|$))|(?:2[0-8]|1\d|0?[1-9]))([-./])(?:1[012]|0?[1-9])\1(?:1[6-9]|[2-9]\d)?\d\d(?:(?=\x20\d)\x20|$))?(((0?[1-9]|1[012])(:[0-5]\d){0,2}(\x20[AP]M))|([01]\d|2[0-3])(:[0-5]\d){1,2})?$" ErrorMessage="dd/mm/yyyy" ControlToValidate="txtToDate"></asp:RegularExpressionValidator> <cc1:ValidatorCalloutExtender id="ValidatorCalloutExtender3" runat="server" __designer:wfdid="w101" TargetControlID="RegularExpressionValidator3">
        </cc1:ValidatorCalloutExtender> &nbsp;&nbsp; <cc1:ValidatorCalloutExtender id="ValidatorCalloutExtender2" runat="server" __designer:wfdid="w102" TargetControlID="RegularExpressionValidator1">
        </cc1:ValidatorCalloutExtender>&nbsp;&nbsp; <cc1:CalendarExtender id="CalendarExtender1" runat="server" __designer:wfdid="w103" TargetControlID="txtFromDate" Format="dd/MM/yyyy"></cc1:CalendarExtender></TD></TR></TBODY></TABLE>
</contenttemplate>
  
  <Triggers>
   <asp:PostBackTrigger ControlID="LnkBtnReport" />
 <asp:PostBackTrigger ControlID="LinkButton1" />
 
 <asp:PostBackTrigger ControlID="LinkButton2" />
  <asp:PostBackTrigger ControlID="LinkButton3" />
  <asp:PostBackTrigger ControlID="LinkButton4" />
   <asp:PostBackTrigger ControlID="lb_lregister" />
 
 


  </Triggers>
  
    </asp:UpdatePanel>
</asp:Content>
<asp:Content ID="Content3" runat="server" ContentPlaceHolderID="ContentPlaceHolder3">
    <asp:Panel ID="Panel5" runat="server" GroupingText="User Tips" Width="100%">
        <br />
    This form is used to close the current day transactions and calculate the total
    collection of the day</asp:Panel>
</asp:Content>

